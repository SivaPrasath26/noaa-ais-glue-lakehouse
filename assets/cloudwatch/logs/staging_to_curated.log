2025-11-26 06:42:36,907 [INFO] Glue-safe logging initialized. Log file: /tmp/logs/etl_log_2025-11-26_06-42-36.log
2025-11-26 06:42:36,908 [INFO] LOG_COUNTS=1
2025-11-26 06:42:37,690 [INFO] Curated Orchestrator started. Spark 3.5.4-amzn-0
2025-11-26 06:42:37,691 [INFO] Mode=incremental window=2024-01-01..2024-01-02
2025-11-26 06:42:37,691 [INFO] ------------------------------------------------------------------------
2025-11-26 06:42:37,691 [INFO] Fact 1 (trajectory_points) started
2025-11-26 06:42:37,697 [INFO] Run mode=incremental, window=2024-01-01..2024-01-02
2025-11-26 06:42:37,697 [INFO] Step: load staging window
2025-11-26 06:42:40,536 [INFO] Step: load state seed from prior day 2023-12-31
2025-11-26 06:42:44,357 [INFO] Step: prepare seeded union of state + staging
2025-11-26 06:42:44,536 [INFO] Step: compute trajectory features (voyage segmentation, haversine, geohash, movement state)
2025-11-26 06:42:44,536 [INFO] Step: compute_trajectory - start window filtering and feature derivation
2025-11-26 06:42:44,553 [INFO] Step: compute_trajectory - deriving lag features (PrevTime, PrevLAT, PrevLON)
2025-11-26 06:42:44,738 [INFO] Step: compute_trajectory - computing voyage_id with seed continuity and 3h gap rule
2025-11-26 06:42:44,839 [INFO] Step: compute_trajectory - calculating haversine distance and geohash
2025-11-26 06:42:44,961 [INFO] Step: compute_trajectory - casting numeric columns to curated types
2025-11-26 06:42:45,106 [INFO] Step: compute_trajectory - deriving movement_state
2025-11-26 06:42:45,134 [INFO] Step: compute_trajectory - filtering window and dropping seed rows
2025-11-26 06:42:45,172 [INFO] Step: compute_trajectory - dropping helper columns and returning
2025-11-26 06:42:45,188 [INFO] Step: write trajectory_points (partitioned by date)
2025-11-26 06:43:01,054 [INFO] [trajectory_points_full] total=14591473, distinct_mmsi=17006
2025-11-26 06:43:30,379 [INFO] [trajectory_points_sampled] total=727241, distinct_mmsi=17006
2025-11-26 06:44:09,923 [INFO] Trajectory fact written to s3a://noaa-ais-curated-data/trajectory_points/ (partitioned by year/month/day)
2025-11-26 06:44:38,390 [INFO] State snapshot written for 2024-01-02 under by_date
2025-11-26 06:44:38,390 [INFO] Fact 1 (trajectory_points) completed in 120.7s
2025-11-26 06:44:38,390 [INFO] ------------------------------------------------------------------------
2025-11-26 06:44:40,709 [INFO] [CHECKPOINT trajectory_points_loaded] rows=727241, distinct_mmsi=17006
2025-11-26 06:44:40,710 [INFO] Fact 2 (voyage_summary) started
2025-11-26 06:44:40,710 [INFO] Step: voyage_summary - aggregation started
2025-11-26 06:44:42,489 [INFO] [voyage_summary] total=21933, distinct_mmsi=17006
2025-11-26 06:44:42,490 [INFO] Step: voyage_summary - write
2025-11-26 06:44:44,127 [INFO] Step: voyage_summary - written to s3a://noaa-ais-curated-data/voyage_summary/
2025-11-26 06:44:44,127 [INFO] Fact 2 (voyage_summary) completed in 3.4s
2025-11-26 06:44:44,127 [INFO] ------------------------------------------------------------------------
2025-11-26 06:44:44,127 [INFO] Curated Orchestrator finished successfully.
2025-11-26 06:44:44,131 [INFO] Glue job committed.